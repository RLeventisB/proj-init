{% extends "index.html" %}

{% block cssjs %}
{% load static %}

<link rel="stylesheet" href="{% static 'miapp/css/post.css'%}">
<link rel="stylesheet" href="{% static 'miapp/css/style1.css'%}">

<link href="{% static 'plugins/css/bootstrap.min.css' %}" type="text/css" media="all" rel="stylesheet"/>
<link href="{% static 'plugins/css/ace.min.css' %}" rel="stylesheet">

<script src="{% static 'plugins/js/jquery.min.js' %}"></script>
<script src="{% static 'plugins/js/bootstrap.min.js' %}"></script>

{% endblock %}
{%block content%}
{% load martortags %}
<nav class="post-header">
    <h1>{{ post.titulo }}</h1>
    <h4>Autor: {{post.nombre}}</h4>
</nav>

<div class="post-content martor-preview">
    {{ post.parrafo | safe_markdown }}

    {% if post.imagen %}
    <img src='{{ post.imagen.url }}'/>
    {% endif %}

</div>

{% if autenticado %}
<h3>Deja un comentario:</h3>
<form method="post">
    {% csrf_token %}
    <div>
        {{ form.as_p }}
    </div>
    <button type="submit" class="btn btn-primary">Publicar</button>
</form>
{% else %}
<p>Debes <a href="{% url 'login' %}">iniciar sesión</a> para comentar.</p>
{% endif %}

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<h3>Comentarios:</h3>
{% for comment in comments %}
<div class="comentario">
    <p>El {{ comment.fecha_comentario.date }} <b>{{ comment.correo.nombre }}</b> escribió:</p><!-- lo mismo-->
    {{ comment.contenido | linebreaks }}<!-- El linebraks ya tiene sus propios <p></p>-->
    {% if comment.correo == usuario_actual %}
    <a href="{% url 'eliminar' comment.pk %}">Eliminar Comentario</a>
    {% endif %}
</div>
{% endfor %}
{%endblock%}
